extends ../layouts/layout

block append head
    //link(rel="stylesheet", href="/stylesheets/partials/b-search.css")
    //link(rel="stylesheet", href="/stylesheets/partials/b-search-line.css")
    //link(rel="stylesheet", href="/stylesheets/partials/b-often-seek.css")
    //link(rel="stylesheet", href="/stylesheets/partials/b-extend-search.css")
    //link(rel="stylesheet", href="/stylesheets/partials/b-dropdown.css")
    //link(rel="stylesheet", href="/stylesheets/partials/b-checkboxes.css")
    //link(rel="stylesheet", href="/stylesheets/partials/b-results.css")
    //link(rel="stylesheet", href="/stylesheets/partials/b-results-item.css")
    //link(rel="stylesheet", href="/stylesheets/partials/b-popup-window.css")
    //link(rel="stylesheet", href="/stylesheets/partials/icons.css")

block content

    =message

    .b-search

        form(id='search-form', method='post', action='/search')
            input.general-input__input(type='hidden', name='#{_csrf.parameterName}', value='#{_csrf.token}')
            .b-search-line
                if form != null
                    if form.query != ""
                        input.b-search-line__input(name='query',
                                                type='text',
                                                value='#{form.query}')
                    else
                        input.b-search-line__input(name='query',
                                                type='text',
                                                placeholder=jadeMessage.getMessage('template.index.search_line.placeholder'))
                else
                    input.b-search-line__input(name='query',
                                            type='text',
                                            placeholder=jadeMessage.getMessage('template.index.search_line.placeholder'))
                .b-search-line__submit
                    button(type='button') #{jadeMessage.getMessage('template.index.button.find_polygraphy')}

            .b-often-seek
                #{jadeMessage.getMessage('template.index.input.often_seek')}
                for service in services
                    .b-often-seek__checkbox
                        if form.services == null
                            - checked = false
                        else
                            - checked = form.services.contains(service.id)
                        input.b-often-seek__input(id='btn#{service.id}',
                                        name='services',
                                        value='#{service.id}',
                                        type='checkbox',
                                        checked=checked)
                        label(for='btn'+service.id)=service.name
            .b-search__wrapper
                .b-extend-search
                    .b-extend-search__title
                        #{jadeMessage.getMessage('template.index.advanced_search.content')}
                    .b-extend-search__label
                        #{jadeMessage.getMessage('template.index.advanced_search.input.payment_method')}
                    .b-dropdown
                        .b-dropdown__placeholder(id='paymentMethod')
                        .b-dropdown__list(id='paymentMethod-list')
                            .b-dropdown__list-item
                                input.b-dropdown__input(id='paymentMethod-item-0',
                                                        name='paymentMethod',
                                                        type='radio',
                                                        value=0,
                                                        checked)
                                label(for='paymentMethod-item-0') #{jadeMessage.getMessage('template.index.advanced_search.input.payment_method.some')}
                            for _paymentMethod in paymentMethods
                                if _paymentMethod.id == form.paymentMethod
                                    - pm_checked = true
                                else
                                    - pm_checked = false
                                .b-dropdown__list-item
                                    input.b-dropdown__input(id='paymentMethod-item-#{_paymentMethod.id}',
                                                            name='paymentMethod',
                                                            type='radio',
                                                            value='#{_paymentMethod.id}',
                                                            checked=pm_checked)
                                    label(for='paymentMethod-item-'+_paymentMethod.id)= _paymentMethod.name

                    .b-checkboxes
                        .b-checkboxes__checkbox
                            if form.writesTheCheck == true
                                - wtc_checked = true
                            else
                                - wtc_checked = false
                            input.js-write-the-check.b-checkboxes__input(id='check1',
                                                                        name='writesTheCheck',
                                                                        type='checkbox',
                                                                        checked=wtc_checked)
                            label(for='check1') #{jadeMessage.getMessage('template.index.advanced_search.input.writes_the_check')}

                    .b-extend-search__label
                        #{jadeMessage.getMessage('template.index.advanced_search.input.delivery_method')}
                    .b-dropdown
                        .b-dropdown__placeholder(id='deliveryMethod')
                        .b-dropdown__list(id='deliveryMethod-list')
                            .b-dropdown__list-item
                                input.b-dropdown__input(id='deliveryMethod-item-0',
                                                        name='deliveryMethod',
                                                        type='radio',
                                                        value=0,
                                                        checked)
                                label(for='deliveryMethod-item-0') #{jadeMessage.getMessage('template.index.advanced_search.input.delivery_method.some')}
                            for _deliveryMethod in deliveryMethods
                                if _deliveryMethod.id == form.deliveryMethod
                                    - dm_checked = true
                                else
                                    - dm_checked = false
                                .b-dropdown__list-item
                                    input.b-dropdown__input(id='deliveryMethod-item-#{_deliveryMethod.id}',
                                                            name='deliveryMethod',
                                                            type='radio',
                                                            value='#{_deliveryMethod.id}',
                                                            checked=dm_checked)
                                    label(for='deliveryMethod-item-'+_deliveryMethod.id)= _deliveryMethod.name

                    .b-checkboxes
                        .b-checkboxes__checkbox
                            if form.orderByEmail == true
                                - obe_checked = true
                            else
                                - obe_checked = false
                            input.js-order-by-email.b-checkboxes__input(id='check2',
                                                            name='orderByEmail',
                                                            type='checkbox',
                                                            checked=obe_checked)
                            label(for='check2') #{jadeMessage.getMessage('template.index.advanced_search.input.order_by_email')}

                .b-search__polygraphies-list
                script(id='results', type='text/x-handlebars-template')
                    .b-results
                        | {{#if polygraphies.length}}
                        ul.b-results__list
                            | {{#each polygraphies}}
                            li.b-results-item
                                table.b-results-item__table-services
                                    tr
                                        td.small-bunner
                                        td.small-t-shirt
                                        td.small-cup
                                    tr
                                        td.small-note
                                        td.small-badge
                                        td.small-magnit
                                    tr
                                        td.small-sticker
                                        td.small-card
                                        td.small-calendar
                                .b-results-item__summary
                                    .b-results-item__name(id='{{id}}') {{name}}
                                    .b-results-item__adaptive-name(id='{{id}}') {{name}}
                                    .b-results-item__address {{address}}
                                    .b-results-item__phone {{phone}}
                                .b-results-item__detail(id='polygraphy-page')

                                    a(href='', id='{{id}}')
                                        #{jadeMessage.getMessage('template.index.list_polygraphies.button.detailed')}

                                button.b-results-item__adaptive-detail-info(type='button', id='{{id}}')
                                    #{jadeMessage.getMessage('template.index.list_polygraphies.button_small.detailed')}
                            | {{/each}}
                        | {{else}}
                        .b-results__empty-results
                            #{jadeMessage.getMessage('template.index.list_polygraphies.empty_result')}
                        | {{/if}}
    .b-search__button-up
    .b-search__overlay
        .b-popup-window
        script(id='pop-up-window-detail', type='text/x-handlebars-template')
            .b-popup-window__main
                .b-popup-window__close
                .b-popup-window__info
                    .b-popup-window__summary
                        .b-popup-window__name {{name}}
                        table.b-popup-window__services
                            tr
                                td.sticker
                                td.A4
                                td.calendar
                                td.magnit
                            tr
                                td.cup
                                td.A1
                                td.bunner
                                td.A2
                        .b-popup-window__address {{address}}
                        .b-popup-window__phone {{phone}}
                        .b-popup-window__email {{email}}
                        .b-popup-window__site
                            a(href='{{website}}', target="_blank") {{website}}
                    .b-popup-window__details
                        .b-popup-window__title
                            #{jadeMessage.getMessage('template.index.popup.headline')}
                        .b-popup-window__about {{{info}}}
                .b-popup-window__helper
    .b-search__js-loader

block append javascript
    script(type='application/javascript', src='/vendor/scripts/handlebars-v3.0.3.js')
    //script(type='application/javascript', src='/scripts/partials/app.js')